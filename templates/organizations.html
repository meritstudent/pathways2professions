{% extends 'base.html' %}

{% block content %}
    <h1>Organizations</h1>

    <form title="organizations" action="organizations" method="POST">

            {% csrf_token %}
            {{filter}}
            <button type="submit" id="submitBt">filter</button>
        </form>

    <ul class="filter_results">
        {% for org in orgs %}
            <li> 
                <h3> {{org.name}} - {{org.location}} </h3> 
                <a href="{{org.link}}">{{org.link}}</a> 
                <p>{{org.description}}</p> 

                {% if org.id in favorites %}
                    <input id="{{org.id}}" type="checkbox" class="favorite_checkbox" label="favorite" checked>
                {% else %}
                    <input id="{{org.id}}" type="checkbox" class="favorite_checkbox" label="favorite">
                {% endif %}
            </li>
        {% endfor %}

            <script type="text/javascript">
                window.addEventListener("click", function(e) {
                    if (e.target.className === "favorite_checkbox") {
                        $.post("toggle", {
                                id: e.target.id, 
                                favorite: e.target.checked,
                                csrfmiddlewaretoken: '{{ csrf_token }}' 
                        });
                    }

                });
            </script>
            
        
    </ul>

{% endblock %}